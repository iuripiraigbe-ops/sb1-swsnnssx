# LegalTok - TikTok JurÃ­dico

Um MVP completo de plataforma de vÃ­deos curtos para educaÃ§Ã£o jurÃ­dica, inspirado no TikTok. Professores podem criar conteÃºdo educativo e alunos podem consumir, interagir e aprender de forma dinÃ¢mica.

## ğŸš€ Funcionalidades

### Para Professores
- âœ… Perfis verificÃ¡veis com especialidades
- âœ… Upload de vÃ­deos curtos (â‰¤90s)
- âœ… TranscodificaÃ§Ã£o automÃ¡tica (720p + thumbnail)
- âœ… Links de contato e calendÃ¡rio de vendas
- âœ… EstatÃ­sticas de engajamento

### Para Alunos
- âœ… Feed infinito de vÃ­deos
- âœ… NavegaÃ§Ã£o por tÃ³picos (Penal, Civil, Constitucional, etc.)
- âœ… Sistema de seguir professores
- âœ… Like, comentÃ¡rio e compartilhamento
- âœ… Feed personalizado (home/following)

### TÃ©cnicas
- âœ… Backend completo com Fastify + TypeScript
- âœ… Banco PostgreSQL com Prisma ORM
- âœ… AutenticaÃ§Ã£o JWT (access + refresh)
- âœ… WebSocket para atualizaÃ§Ãµes em tempo real
- âœ… Fila Redis + BullMQ para transcodificaÃ§Ã£o
- âœ… Frontend React + TypeScript + Tailwind
- âœ… Upload de arquivos com validaÃ§Ã£o
- âœ… Rate limiting e CORS

## ğŸ› ï¸ Stack TecnolÃ³gica

### Backend
- **Runtime**: Node.js 20.x
- **Framework**: Fastify
- **Database**: PostgreSQL 16
- **ORM**: Prisma
- **Cache/Fila**: Redis + BullMQ
- **Auth**: JWT + bcrypt
- **Upload**: Multipart + ffmpeg
- **WebSocket**: ws
- **ValidaÃ§Ã£o**: Zod

### Frontend
- **Framework**: React 18 + TypeScript
- **Build**: Vite
- **Styling**: Tailwind CSS
- **State**: Zustand
- **Forms**: React Hook Form + Yup
- **Icons**: Lucide React
- **Animations**: Framer Motion

### DevOps
- **ContainerizaÃ§Ã£o**: Docker + Docker Compose
- **Database**: PostgreSQL + pgAdmin
- **Cache**: Redis
- **CI/CD**: GitHub Actions (configurado)

## ğŸ“‹ PrÃ©-requisitos

- Node.js 20.x ou superior
- Docker e Docker Compose
- FFmpeg instalado no sistema (para transcodificaÃ§Ã£o)

### Instalando FFmpeg

**Windows:**
```bash
# Via Chocolatey
choco install ffmpeg

# Ou baixe de https://ffmpeg.org/download.html
```

**macOS:**
```bash
brew install ffmpeg
```

**Linux (Ubuntu/Debian):**
```bash
sudo apt update
sudo apt install ffmpeg
```

## ğŸš€ InstalaÃ§Ã£o e ConfiguraÃ§Ã£o

### 1. Clone o repositÃ³rio
```bash
git clone https://github.com/iuripiraigbe-ops/sb1-swsnnssx.git
cd sb1-swsnnssx
```

### 2. Configure as variÃ¡veis de ambiente

Crie um arquivo `.env` na raiz do projeto:
```env
VITE_API_URL=http://localhost:3001
VITE_WS_URL=ws://localhost:3001/ws
```

Crie um arquivo `.env` na pasta `server/`:

**Para Desenvolvimento Local:**
```env
# Database
DATABASE_URL="postgresql://legaltok:legaltok123@localhost:5432/legaltok?schema=public"

# Redis
REDIS_URL="redis://localhost:6379"

# JWT
JWT_SECRET="dev-secret-key-change-in-production"
JWT_REFRESH_SECRET="dev-refresh-secret-key-change-in-production"
JWT_EXPIRES_IN="15m"
JWT_REFRESH_EXPIRES_IN="7d"

# Server
PORT=3001
NODE_ENV="development"

# File Upload
UPLOAD_DIR="./uploads"
MAX_FILE_SIZE=100000000

# CORS
CORS_ORIGIN="http://localhost:5173"

# Rate Limiting
RATE_LIMIT_MAX=100
RATE_LIMIT_WINDOW_MS=900000
```

**Para ProduÃ§Ã£o (Neon + Upstash):**
Veja `MIGRATION_GUIDE.md` para configuraÃ§Ã£o completa.

### 3. Inicie os serviÃ§os de infraestrutura
```bash
docker-compose up -d
```

Isso irÃ¡ iniciar:
- PostgreSQL na porta 5432
- Redis na porta 6379
- pgAdmin na porta 8080 (admin@legaltok.com / admin123)

### 4. Configure o banco de dados
```bash
cd server
npm install
npx prisma generate
npx prisma db push
npm run db:seed
```

### 5. Instale as dependÃªncias do frontend
```bash
cd ..
npm install
```

### 6. Inicie os servidores

**Terminal 1 - Backend:**
```bash
cd server
npm run dev
```

**Terminal 2 - Frontend:**
```bash
npm run dev
```

## ğŸ¯ Como Usar

### Acessando a aplicaÃ§Ã£o
- **Frontend**: http://localhost:5173
- **Backend API**: http://localhost:3001
- **pgAdmin**: http://localhost:8080

### Contas de teste
ApÃ³s rodar o seed, vocÃª pode usar estas contas:

**Professores:**
- Email: `ana.silva@legaltok.com` / Senha: `123456`
- Email: `carlos.santos@legaltok.com` / Senha: `123456`
- Email: `maria.costa@legaltok.com` / Senha: `123456`

**Alunos:**
- Email: `joao.aluno@email.com` / Senha: `123456`
- Email: `maria.aluna@email.com` / Senha: `123456`

### Fluxo de uso

1. **Registro/Login**: Acesse a aplicaÃ§Ã£o e faÃ§a login
2. **Feed**: Navegue pelos vÃ­deos no feed principal
3. **Upload** (professores): FaÃ§a upload de vÃ­deos educativos
4. **InteraÃ§Ã£o**: Like, comente e siga professores
5. **TÃ³picos**: Explore vÃ­deos por Ã¡rea do direito

## ğŸ“ Estrutura do Projeto

```
sb1-swsnnssx/
â”œâ”€â”€ src/                    # Frontend React
â”‚   â”œâ”€â”€ components/         # Componentes React
â”‚   â”œâ”€â”€ hooks/             # Custom hooks
â”‚   â”œâ”€â”€ lib/               # UtilitÃ¡rios (API client)
â”‚   â”œâ”€â”€ services/          # ServiÃ§os mockados (legacy)
â”‚   â”œâ”€â”€ store/             # Estado global (Zustand)
â”‚   â””â”€â”€ types/             # Tipos TypeScript
â”œâ”€â”€ server/                # Backend Fastify
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ routes/        # Rotas da API
â”‚   â”‚   â”œâ”€â”€ services/      # ServiÃ§os (Redis, WebSocket, etc.)
â”‚   â”‚   â”œâ”€â”€ middleware/    # Middlewares (auth, etc.)
â”‚   â”‚   â”œâ”€â”€ types/         # Tipos e schemas Zod
â”‚   â”‚   â””â”€â”€ queues/        # Filas de processamento
â”‚   â”œâ”€â”€ prisma/            # Schema e migrations
â”‚   â””â”€â”€ uploads/           # Arquivos de vÃ­deo
â”œâ”€â”€ docker-compose.yml     # ServiÃ§os de infraestrutura
â””â”€â”€ README.md             # Este arquivo
```

## ğŸ”§ Scripts DisponÃ­veis

### Frontend
```bash
npm run dev          # Desenvolvimento
npm run build        # Build de produÃ§Ã£o
npm run preview      # Preview da build
npm run lint         # Linting
```

### Backend
```bash
cd server
npm run dev          # Desenvolvimento
npm run build        # Build
npm run start        # ProduÃ§Ã£o
npm run db:seed      # Popular banco
npm run db:studio    # Prisma Studio
npm run test         # Testes
```

## ğŸ§ª Testes

### Backend
```bash
cd server
npm test             # Testes unitÃ¡rios
npm run test:e2e     # Testes end-to-end
```

### Frontend
```bash
npm test             # Testes (configurar primeiro)
```

## ğŸ“Š API Endpoints

### AutenticaÃ§Ã£o
- `POST /auth/register` - Registro
- `POST /auth/login` - Login
- `POST /auth/refresh` - Refresh token
- `GET /me` - Perfil do usuÃ¡rio

### VÃ­deos
- `GET /videos/feed` - Feed de vÃ­deos
- `POST /videos` - Upload de vÃ­deo
- `GET /videos/:id` - Detalhes do vÃ­deo
- `POST /videos/:id/like` - Like/Unlike
- `GET /videos/:id/comments` - ComentÃ¡rios
- `POST /videos/:id/comments` - Adicionar comentÃ¡rio

### UsuÃ¡rios
- `GET /users/:id` - Perfil do usuÃ¡rio
- `POST /users/follow/:id` - Seguir usuÃ¡rio
- `DELETE /users/follow/:id` - Deixar de seguir

### TÃ³picos
- `GET /topics` - Lista de tÃ³picos
- `GET /topics/:slug` - Detalhes do tÃ³pico
- `GET /topics/:slug/videos` - VÃ­deos do tÃ³pico

## ğŸ”’ SeguranÃ§a

- AutenticaÃ§Ã£o JWT com refresh tokens
- Senhas hasheadas com bcrypt
- Rate limiting por IP
- ValidaÃ§Ã£o de entrada com Zod
- CORS configurado
- Upload de arquivos validado

## ğŸš€ Deploy

### ProduÃ§Ã£o
1. Configure variÃ¡veis de ambiente de produÃ§Ã£o
2. Use um serviÃ§o de transcodificaÃ§Ã£o (Mux, Cloudflare Stream)
3. Configure CDN para vÃ­deos
4. Use Redis Cloud ou similar
5. Configure PostgreSQL em produÃ§Ã£o

### Docker
```bash
# Build das imagens
docker-compose -f docker-compose.prod.yml build

# Deploy
docker-compose -f docker-compose.prod.yml up -d
```

## ğŸ¤ Contribuindo

1. Fork o projeto
2. Crie uma branch para sua feature (`git checkout -b feature/AmazingFeature`)
3. Commit suas mudanÃ§as (`git commit -m 'Add some AmazingFeature'`)
4. Push para a branch (`git push origin feature/AmazingFeature`)
5. Abra um Pull Request

## ğŸ“ LicenÃ§a

Este projeto estÃ¡ sob a licenÃ§a MIT. Veja o arquivo `LICENSE` para mais detalhes.

## ğŸ†˜ Suporte

Se vocÃª encontrar algum problema ou tiver dÃºvidas:

1. Verifique se todos os prÃ©-requisitos estÃ£o instalados
2. Confirme se os serviÃ§os Docker estÃ£o rodando
3. Verifique os logs do servidor
4. Abra uma issue no GitHub

## ğŸ¯ PrÃ³ximos Passos

- [ ] IntegraÃ§Ã£o com Mux/Cloudflare Stream
- [ ] NotificaÃ§Ãµes push
- [ ] ModeraÃ§Ã£o de conteÃºdo
- [ ] Analytics avanÃ§ados
- [ ] App mobile (React Native)
- [ ] Pagamentos e assinaturas
- [ ] Live streaming
- [ ] GamificaÃ§Ã£o

---

**LegalTok** - Transformando a educaÃ§Ã£o jurÃ­dica atravÃ©s de vÃ­deos curtos e dinÃ¢micos! ğŸ“šâš–ï¸